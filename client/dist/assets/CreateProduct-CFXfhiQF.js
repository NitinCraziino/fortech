import{Q as T,e as V,u as _,a as $,R as H,b as K,r as l,U as Q,d as W,j as e,K as X,B as N,E as h,I as j,V as z,W as G,X as J}from"./index-V67Iib8C.js";import{T as Y}from"./textarea-BDxdewHG.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=T("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),ae=()=>{const{success:U,errorToast:C}=V(),P=_(),k=$(),{id:o}=H(),b=K(),n=k.pathname.includes("/view-product/"),d=k.pathname.includes("/edit-product/");l.useEffect(()=>{o&&(n||d)&&b(Q({_id:o}))},[o,n,d]);const{product:v,error:w,loading:B}=W(t=>t.product);l.useEffect(()=>{v&&I(v),w&&C(w)},[v,w]);const[s,y]=l.useState({partNo:"",unitPrice:0,unitOfMeasure:"",description:"",image:null,name:""}),O=l.useRef(null),[M,E]=l.useState(null),[i,S]=l.useState({partNo:"",unitPrice:"",unitOfMeasure:"",description:"",image:"",name:""}),I=t=>{const{partNo:a,unitPrice:r,unit:p,description:f,image:x,name:g,customerPrice:c}=t;y({name:g,partNo:a,unitPrice:c||r,unitOfMeasure:p||"",description:f,image:null}),x&&E(`https://www.naisorders.com${x}`)},u=t=>{const{name:a,value:r}=t.target;y({...s,[a]:a==="unitPrice"?parseFloat(r):r})},F=t=>{let a="";switch(t){case"name":s.name.trim()||(a="Product name is required.");break;case"partNo":s.partNo.trim()||(a="Part number is required.");break;case"unitPrice":(!s.unitPrice||s.unitPrice<=0)&&(a="Unit price must be a positive number.");break;case"unitOfMeasure":s.unitOfMeasure.trim()||(a="Unit of measure is required.");break;case"description":s.description.trim()||(a="Description is required.");break;case"image":!s.image&&!M&&(a="Product image is required.");break}S(r=>({...r,[t]:a}))},D=()=>{O.current&&O.current.click()},R=t=>{if(t.target.files&&t.target.files[0]){const a=t.target.files[0];y({...s,image:a}),E(URL.createObjectURL(a))}},q=()=>{let t=!0;return["partNo","unitPrice","unitOfMeasure","description","image","name"].forEach(r=>{F(r),i[r]&&(t=!1)}),t},m=t=>{F(t)},L=async t=>{if(t.preventDefault(),q()){const{partNo:a,unitPrice:r,unitOfMeasure:p,description:f,image:x,name:g}=s;let c=null;try{d&&o?c=await b(G({name:g,partNo:a,unitPrice:r.toString(),unit:p,description:f,image:x,_id:o})).unwrap():c=await b(J({name:g,partNo:a,unitPrice:r.toString(),unit:p,description:f,image:x})).unwrap(),c&&(U(d?"Product updated.":"Product added."),P("/products"))}catch(A){C("Error adding product"),console.log("ðŸš€ ~ handleSubmit ~ error:",A)}}};return e.jsxs("div",{className:"p-6 mx-auto",children:[e.jsx(X,{show:B,fullScreen:!0}),e.jsxs("form",{onSubmit:L,className:"space-y-6 bg-[#F2F2F2] rounded-lg p-4 max-w-[700px]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative w-24 h-24 rounded-full overflow-hidden bg-white flex items-center justify-center border border-[#CBD5E1]",children:M?e.jsx("img",{src:M,alt:"Product",className:"object-cover"}):e.jsx("span",{className:"text-[10px] text-[#94A3B8]",children:"No image"})}),!n&&e.jsxs("div",{children:[e.jsx("input",{type:"file",accept:"image/*",ref:O,onChange:R,className:"hidden",id:"imageUpload"}),e.jsx("label",{htmlFor:"imageUpload",children:e.jsxs(N,{onClick:D,type:"button",variant:"outline",className:"bg-white hover:bg-white/80",children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Upload Image"]})}),i.image&&e.jsx("p",{className:"text-xs text-red-500",children:i.image})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(h,{htmlFor:"partNo",className:"text-sm",children:"Product Name"}),e.jsx(j,{id:"name",readOnly:n,type:"text",placeholder:"Enter product name",className:"bg-white",name:"name",value:s.name,onBlur:()=>m("name"),onChange:u}),i.name&&e.jsx("p",{className:"text-xs text-red-500",children:i.name})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(h,{htmlFor:"partNo",className:"text-sm",children:"Part No."}),e.jsx(j,{id:"partNo",readOnly:n,type:"text",placeholder:"Enter Part No.",className:"bg-white",name:"partNo",value:s.partNo,onBlur:()=>m("partNo"),onChange:u}),i.partNo&&e.jsx("p",{className:"text-xs text-red-500",children:i.partNo})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(h,{htmlFor:"unitPrice",className:"text-sm",children:"Unit Price ($)"}),e.jsx(j,{id:"unitPrice",readOnly:n,type:"number",step:"0.01",name:"unitPrice",value:s.unitPrice,onChange:u,onBlur:()=>m("unitPrice"),placeholder:"Enter Unit Price",className:"bg-white"}),i.unitPrice&&e.jsx("p",{className:"text-xs text-red-500",children:i.unitPrice})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(h,{htmlFor:"unitOfMeasure",className:"text-sm",children:"Unit of Measure"}),e.jsx(j,{readOnly:n,id:"unitOfMeasure",placeholder:"Enter Unit of Measure",className:"bg-white",name:"unitOfMeasure",value:s.unitOfMeasure,onChange:u,onBlur:()=>m("unitOfMeasure"),type:"text"}),i.unitOfMeasure&&e.jsx("p",{className:"text-xs text-red-500",children:i.unitOfMeasure})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(h,{htmlFor:"description",className:"text-sm",children:"Description"}),e.jsx(Y,{readOnly:n,id:"description",placeholder:"Enter text here",className:"min-h-[120px] bg-white",name:"description",value:s.description,onBlur:()=>m("description"),onChange:u}),i.description&&e.jsx("p",{className:"text-xs text-red-500",children:i.description})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[!n&&e.jsxs(z.Fragment,{children:[e.jsx(N,{onClick:()=>P("/products"),type:"button",variant:"outline",className:"bg-white hover:bg-white/80",children:"Cancel"}),e.jsx(N,{type:"submit",children:d?"Update":"Create"})]}),n&&e.jsx(N,{onClick:()=>P("/products"),type:"button",children:"Back"})]})]})]})};export{ae as default};
