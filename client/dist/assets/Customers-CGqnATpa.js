import{Q as k,r as n,u as F,h as T,i as z,k as D,m as V,n as B,j as e,T as q,o as A,p as b,q as H,s as I,t as O,v as R,B as N,Y as K,L,I as y,e as _,b as U,d as $,w as Q,K as Y,Z}from"./index-V67Iib8C.js";import{C as P,E as G,P as J}from"./Pagination-CWW75XFJ.js";import"./select-CsmTK3g7.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=k("Import",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m8 11 4 4 4-4",key:"1dohi6"}],["path",{d:"M8 5H4a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-4",key:"1ywtjm"}]]);function X(o){var j;const[x,v]=n.useState([]),[r,c]=n.useState([]),[u,g]=n.useState({}),[C,f]=n.useState({}),p=F(),h=()=>[{accessorKey:"name",header:({column:s})=>e.jsxs(N,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"flex items-center gap-2",children:["Name",e.jsx(P,{size:14})]}),cell:({row:s})=>e.jsx("div",{className:"capitalize ms-4",children:s.getValue("name")})},{accessorKey:"email",header:({column:s})=>e.jsxs(N,{variant:"ghost",onClick:()=>s.toggleSorting(s.getIsSorted()==="asc"),className:"flex items-center gap-2",children:["Email",e.jsx(P,{size:14})]}),cell:({row:s})=>e.jsx("div",{className:"lowercase",children:s.getValue("email")})},{accessorKey:"active",header:"Status",cell:({row:s})=>e.jsx("div",{className:"capitalize",children:s.getValue("active")?"Active":"Inactive"})},{id:"actions",header:()=>e.jsx("div",{className:"text-center",children:"Actions"}),enableHiding:!1,cell:({row:s})=>{const w=s.original;return e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex items-center justify-center gap-2",children:e.jsx(N,{onClick:()=>p(`/customer-prices/${w._id}`),variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(G,{className:"h-4 w-4"})})})})}}],m=T({data:o.customers,columns:h(),onSortingChange:v,onColumnFiltersChange:c,getCoreRowModel:z(),getPaginationRowModel:D(),getSortedRowModel:V(),getFilteredRowModel:B(),onColumnVisibilityChange:g,onRowSelectionChange:f,state:{sorting:x,columnFilters:r,columnVisibility:u,rowSelection:C,pagination:{pageIndex:o.pageIndex-1,pageSize:o.pageSize}}});return e.jsx("div",{className:"w-full",children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(q,{children:[e.jsx(A,{children:m.getHeaderGroups().map(a=>e.jsx(b,{children:a.headers.map(s=>e.jsx(H,{children:s.isPlaceholder?null:I(s.column.columnDef.header,s.getContext())},s.id))},a.id))}),e.jsx(O,{children:(j=m.getRowModel().rows)!=null&&j.length?m.getRowModel().rows.map(a=>e.jsx(b,{"data-state":a.getIsSelected()&&"selected",children:a.getVisibleCells().map(s=>e.jsx(R,{children:I(s.column.columnDef.cell,s.getContext())},s.id))},a.id)):e.jsx(b,{children:e.jsx(R,{colSpan:h().length,className:"h-24 text-center",children:"No results."})})})]})})})}function ee({open:o,onOpenChange:x,inviteCustomer:v}){const[r,c]=n.useState({email:"",customerName:"",products:null}),[u,g]=n.useState({email:"",customerName:""}),[C,f]=n.useState(!1),[p,h]=n.useState({}),m=n.useRef(null),j=(l,t)=>{if(typeof t=="string"){if(l==="email"){const i=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(t){if(!i.test(t))return"Invalid email format."}else return"Email is required."}if(l==="customerName"&&!t.trim())return"Customer name is required."}};n.useEffect(()=>{o||(c({email:"",customerName:"",products:null}),g({email:"",customerName:""}))},[o]);const a=l=>{l.preventDefault();const t={};if(Object.keys(r).forEach(i=>{const d=j(i,r[i]);d&&(t[i]=d)}),g(t),Object.keys(t).length===0){f(!0);try{console.log("Form submitted:",r),v(r)}catch(i){console.error("Invite error:",i)}finally{f(!1)}}},s=l=>{const{name:t,value:i}=l.target;h(S=>({...S,[t]:!0}));const d=j(t,i);d&&g(S=>({...S,[t]:d}))},w=l=>{const{name:t,value:i}=l.target;c(d=>({...d,[t]:i})),g(d=>({...d,[t]:""}))},E=()=>{m.current&&m.current.click()},M=async l=>{l.target.files&&l.target.files[0]&&c(t=>({...t,products:l.target.files[0]}))};return e.jsx(K,{open:o,onOpenChange:x,content:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-1",children:"Invite Customer"}),e.jsx("p",{className:"text-[#334155] text-sm mb-5",children:"Enter the Name & Email address whom you want to invite"}),e.jsx("input",{type:"file",accept:".csv",ref:m,onChange:M,className:"hidden",id:"imageUpload"}),e.jsxs("div",{className:"flex items-center justify-end gap-10 mb-5",children:[e.jsxs(N,{variant:"shadow",onClick:E,className:"min-w-[130px] flex gap-3 items-center justify-center px-4",size:"lg",children:[e.jsx(W,{className:"size-10"}),"Import Products"]}),e.jsx(L,{target:"_blank",to:"https://www.naisorders.com/uploads/products_list.csv",className:"text-[10px] font-medium underline underline-offset-2 text-[#0075FF] hover:text-blue-700 transition-all duration-200",children:"Download Products List"})]}),e.jsxs("form",{onSubmit:a,className:"flex flex-col gap-4",children:[e.jsx(y,{type:"text",name:"customerName",value:r.customerName,onChange:w,onBlur:s,placeholder:"Customer name",className:"w-full",required:!0}),p.customerName&&u.customerName&&e.jsx("p",{className:"text-xs text-red-500",children:u.customerName}),e.jsx(y,{name:"email",value:r.email,onChange:w,onBlur:s,type:"email",placeholder:"example@email.com",className:"w-full",required:!0}),p.email&&u.email&&e.jsx("p",{className:"text-xs text-red-500",children:u.email}),e.jsx(N,{disabled:C,type:"submit",className:"w-full mt-1",children:"Send Invite"})]})]})})}const ne=()=>{const[o,x]=n.useState(!1),[v,r]=n.useState(1),[c,u]=n.useState(10),{errorToast:g,success:C}=_(),f=U(),{customers:p,error:h,loading:m}=$(a=>a.customer);n.useEffect(()=>{f(Q({}))},[]),n.useEffect(()=>{h&&g(h)},[h]);const j=async a=>{try{await f(Z(a)).unwrap(),x(!1),C("Invitation sent.")}catch(s){console.log("ðŸš€ ~ handleInviteCustomer ~ error:",s)}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-6",children:[e.jsx(Y,{show:m,fullScreen:!0}),e.jsxs("div",{className:"flex gap-6 mb-6",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx(y,{type:"text",placeholder:"Search",className:"focus-visible:outline-none ps-10 !h-10"}),e.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-5",children:e.jsx("img",{src:"icons/search.svg",alt:"search"})})]}),e.jsx("div",{children:e.jsx(N,{size:"lg",className:"px-[22px]",onClick:()=>x(!0),children:"Invite Customer"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(X,{pageIndex:v,pageSize:c,customers:p}),e.jsx(J,{currentPage:v,totalPages:Math.ceil(p.length/c),rowsPerPage:c,onPageChange:r,onRowsPerPageChange:a=>{u(a),r(1)}})]})]}),e.jsx(ee,{inviteCustomer:j,open:o,onOpenChange:x})]})};export{ne as default};
